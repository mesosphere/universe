{
  "id": "/{{kafka.name}}/{{kafka.user}}",
  "cpus": {{kafka.cpus}},
  "mem": {{kafka.mem}},
  "instances": {{kafka.instances}},
  "container": {
      "type": "DOCKER",
      "volumes": [
      {
              "containerPath": "{{broker.log_dir}}",
              "hostPath": "{{broker.log_dir}}",
              "mode": "RW"
      }
      ],
      "docker": {
          "network": "HOST",
          "image": "{{resource.assets.container.docker.kafka}}",
          "forcePullImage": true,
          "privileged":true
      }
  },
  "ports":[{{broker.port}}, {{broker.jmx_port}}],
  "requirePorts":true,
  "constraints":[
    ["hostname","UNIQUE"],
    ["app", "LIKE", "{{kafka.mesos_agent_app_lable}}"]
  ],
  "env": {
      "KAFKA_ZOOKEEPER_CONNECT": "{{broker.zookeeper}}",
      "KAFKA_LOG_PARENT_DIR": "{{broker.log_dir}}"
  },
  "healthChecks":[
    {
      "protocol": "COMMAND",
      "command": { "value": "nc -zv $HOST $PORT0" },
      "intervalSeconds": 5
    },
    {
      "protocol": "COMMAND",
      "command": { "value": "nc -zv $HOST $PORT1" },
      "intervalSeconds": 5
    }
  ]
}
