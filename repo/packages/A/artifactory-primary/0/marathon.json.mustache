{
    "id": "{{artifactory-primary.framework-name}}",
    "cpus": {{artifactory-primary.cpus}},
    "mem": {{artifactory-primary.mem}},
    "instances": 1,
    "container": {
        "type": "DOCKER",
        "docker": {
            "image": "{{resource.assets.container.docker.artifactory-ha-primary}}",
            "network": "HOST"
        },
        "volumes": [
            {
                "containerPath": "/var/opt/jfrog/cluster",
                "hostPath": "{{artifactory-primary.cluster-home}}/cluster-home",
                "mode": "RW"
            }
         ]
    },
    "portDefinitions": [
        {
            "port": 0,
            "protocol": "tcp",
            "name": "instance",
            "labels": {}
        },
        {
            "port": 0,
            "protocol": "tcp",
            "name": "member",
            "labels": {}
        }
        ],
    "env": {
            "ART_DATABASE_CONNECTION_STRING": "{{artifactory-primary.database.database-connection-string}}",
            "ART_DATABASE_USER":  "{{artifactory-primary.database.database-user}}",
            "ART_DATABASE_PASSWORD":  "{{artifactory-primary.database.database-password}}",
            "ART_LICENSES": "{{artifactory-primary.artifactory-licenses}}"
    },
    "labels": {
            "MARATHON_SINGLE_INSTANCE_APP": "true",
            "DCOS_PACKAGE_FRAMEWORK_NAME": "{{artifactory-primary.framework-name}}"
    },
    "upgradeStrategy":{
            "minimumHealthCapacity": 0,
            "maximumOverCapacity": 0
    },
    "healthChecks": [
        {
            "gracePeriodSeconds": 3,
            "intervalSeconds": 10,
            "maxConsecutiveFailures": 3,
            "path": "/artifactory/api/system/ping",
            "portIndex": 0,
            "protocol": "HTTP",
            "timeoutSeconds": 10
        }
        ],
    {{#artifactory-primary.unique-nodes}}
            "constraints": [["hostname", "UNIQUE"]]
    {{/artifactory-primary.unique-nodes}}
}
