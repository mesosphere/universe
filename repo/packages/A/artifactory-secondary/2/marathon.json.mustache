{
"id": "{{artifactory-secondary.framework-name}}",
"cpus": {{artifactory-secondary.cpus}},
"mem": {{artifactory-secondary.mem}},
{{^artifactory-secondary.high-availability.enabled}}
    "instances": 1,
{{/artifactory-secondary.high-availability.enabled}}
{{#artifactory-secondary.high-availability.enabled}}
    "instances": {{artifactory-secondary.high-availability.nodes}},
{{/artifactory-secondary.high-availability.enabled}}
"container": {
"type": "DOCKER",
"docker": {
{{^artifactory-secondary.high-availability.enabled}}
    "image": "{{resource.assets.container.docker.artifactory-pro}}",
{{/artifactory-secondary.high-availability.enabled}}
{{#artifactory-secondary.high-availability.enabled}}
    "image": "{{resource.assets.container.docker.artifactory-ha-secondary}}",
{{/artifactory-secondary.high-availability.enabled}}
"network": "HOST",
"forcePullImage":true
},
"volumes": [
{{^artifactory-secondary.high-availability.enabled}}
    {
    "containerPath": "/var/opt/jfrog/artifactory/data",
    "hostPath": "{{artifactory-secondary.artifactory-home}}/{{artifactory-secondary.framework-name}}/data",
    "mode": "RW"
    },
    {
    "containerPath": "/var/opt/jfrog/artifactory/logs",
    "hostPath": "{{artifactory-secondary.artifactory-home}}/{{artifactory-secondary.framework-name}}/logs",
    "mode": "RW"
    },
    {
    "containerPath": "/var/opt/jfrog/artifactory/backup",
    "hostPath": "{{artifactory-secondary.artifactory-home}}/{{artifactory-secondary.framework-name}}/backup",
    "mode": "RW"
    }
{{/artifactory-secondary.high-availability.enabled}}
{{#artifactory-secondary.high-availability.enabled}}
    {
    "containerPath": "/var/opt/jfrog/cluster",
    "hostPath": "{{artifactory-secondary.high-availability.cluster-home}}/cluster-home",
    "mode": "RW"
    },
    {
    "containerPath": "/var/opt/jfrog/artifactory/logs",
    "hostPath": "{{artifactory-secondary.high-availability.cluster-home}}/{{artifactory-secondary.framework-name}}/logs",
    "mode": "RW"
    },
    {
    "containerPath": "//var/opt/jfrog/artifactory/data",
    "hostPath": "{{artifactory-secondary.high-availability.cluster-home}}/{{artifactory-secondary.framework-name}}/data",
    "mode": "RW"
    },
    {
    "containerPath": "/var/opt/jfrog/artifactory/backup",
    "hostPath": "{{artifactory-secondary.high-availability.cluster-home}}/{{artifactory-secondary.framework-name}}/backup",
    "mode": "RW"
    }
{{/artifactory-secondary.high-availability.enabled}}
]
},
"portDefinitions": [
{
"port": 0,
"protocol": "tcp",
"name": "instance",
"labels": {}
},
{
"port": 0,
"protocol": "tcp",
"name": "member",
"labels": {}
}
],
"healthChecks": [
{
"gracePeriodSeconds": 3,
"intervalSeconds": 10,
"maxConsecutiveFailures": 3,
"path": "/artifactory/api/system/ping",
"portIndex": 0,
"protocol": "HTTP",
"timeoutSeconds": 10
}
]
{{#artifactory-secondary.high-availability.unique-nodes}},
"constraints": [["hostname", "UNIQUE"]]
{{/artifactory-secondary.high-availability.unique-nodes}}
}
