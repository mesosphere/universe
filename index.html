<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Universe by mesosphere</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Universe</h1>
        <p>The Mesosphere DCOS package repository.</p>

        <p class="view"><a href="https://github.com/mesosphere/universe">View the Project on GitHub <small>mesosphere/universe</small></a></p>


        <ul>
          <li><a href="https://github.com/mesosphere/universe/zipball/version-3.x">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/mesosphere/universe/tarball/version-3.x">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/mesosphere/universe">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="mesosphere-universe" class="anchor" href="#mesosphere-universe" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Mesosphere Universe</h1>

<table>
<thead>
<tr>
<th>Build</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>CI</td>
<td><a href="https://teamcity.mesosphere.io/viewType.html?buildTypeId=Oss_Universe_Ci&amp;guest=1"><img src="https://teamcity.mesosphere.io/guestAuth/app/rest/builds/buildType:(id:Oss_Universe_Ci)/statusIcon" alt="Build Status"></a></td>
</tr>
<tr>
<td>Universe Server</td>
<td><a href="https://teamcity.mesosphere.io/viewType.html?buildTypeId=Oss_Universe_UniverseServer&amp;guest=1"><img src="https://teamcity.mesosphere.io/guestAuth/app/rest/builds/buildType:(id:Oss_Universe_UniverseServer)/statusIcon" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<p>Mesosphere Universe registry of packages made available for DC/OS Clusters.</p>

<h4>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of Contents</h4>

<ul>
<li><a href="#universe-purpose">Universe Purpose</a></li>
<li>
<a href="#publish-a-package-1">Publish a Package</a>

<ul>
<li>
<a href="#creating-a-package">Creating a Package</a>

<ul>
<li>
<a href="#packagejson"><code>package.json</code></a>

<ul>
<li><a href="#mindcosreleaseversion"><code>.minDcosReleaseVersion</code></a></li>
</ul>
</li>
<li><a href="#configjson"><code>config.json</code></a></li>
<li><a href="#marathonjsonmustache"><code>marathon.json.mustache</code></a></li>
<li><a href="#commandjson"><code>command.json</code></a></li>
<li>
<a href="#resourcejson"><code>resource.json</code></a>

<ul>
<li><a href="#docker-images">Docker Images</a></li>
<li><a href="#images">Images</a></li>
<li><a href="#cli-resources">CLI Resources</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#submit-your-package">Submit your Package</a></li>
</ul>
</li>
<li>
<a href="#repository-consumption-1">Repository Consumption</a>

<ul>
<li>
<a href="#universe-server">Universe Server</a>

<ul>
<li><a href="#build-universe-server-locally">Build Universe Server locally</a></li>
<li><a href="#run-universe-server">Run Universe Server</a></li>
</ul>
</li>
<li><a href="#consumption-protocol">Consumption Protocol</a></li>
<li><a href="#supported-dcos-versions">Supported DC/OS Versions</a></li>
</ul>
</li>
</ul>

<h2>
<a id="universe-purpose" class="anchor" href="#universe-purpose" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Universe Purpose</h2>

<p>This git repo facilitates three necessary functions to publish, store and consume packages.</p>

<h3>
<a id="publish-a-package" class="anchor" href="#publish-a-package" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Publish a Package</h3>

<p>To publish a package to Universe, fork this repo and open a Pull Request. A set of automated builds will be run against
the Pull Request to ensure the modifications made in the PR leave the Universe well formed.
See <a href="#creating-a-package">Creating a Package</a> for details.</p>

<h3>
<a id="registry-of-packages" class="anchor" href="#registry-of-packages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Registry of Packages</h3>

<p>The registry of published packages is maintained as the contents of this repo in the <code>repo/packages</code> directory. As of
repository version <code>3.0</code> multiple packaging versions are allowed to co-exist in the same repository. Validation of
packages are coordinated based on the packaging version defined in <code>package.json</code>.</p>

<h3>
<a id="repository-consumption" class="anchor" href="#repository-consumption" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Repository Consumption</h3>

<p>In order for published packages to be consumed and installed in a DC/OS Cluster the Universe Server needs to be built
and run in a location accessible by the DC/OS Cluster. See <a href="#universe-server">Universe Server</a> for details on
building the Universe artifacts and Server.</p>

<h2>
<a id="publish-a-package-1" class="anchor" href="#publish-a-package-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Publish a Package</h2>

<h3>
<a id="creating-a-package" class="anchor" href="#creating-a-package" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating a Package</h3>

<p>Each package has its own directory, with one subdirectory for each package revision. Each package revision directory
contains the set of files necessary to create a consumable package that can be used by a DC/OS Cluster to install
the package.</p>

<pre><code>└── repo/package/F/foo
    ├── 0
    │   ├── command.json
    │   ├── config.json
    │   ├── marathon.json.mustache
    │   ├── resource.json
    │   └── package.json
    ├── 1
    │   ├── command.json
    │   ├── config.json
    │   ├── marathon.json.mustache
    │   ├── resource.json
    │   └── package.json
    └── ...
</code></pre>

<h4>
<a id="packagejson" class="anchor" href="#packagejson" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>package.json</code>
</h4>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>required</td>
</tr>
<tr>
<td>3.0</td>
<td>required</td>
</tr>
</tbody>
</table>

<p>Every package in Universe must have a <code>package.json</code> file which specifies the high level metadata about the package.</p>

<p>Currently, a package can specify one of two values for <code>.packagingVersion</code> either <code>2.0</code> or <code>3.0</code>; which version is declared
will dictate which other files are required for the complete package as well as the schema(s) all the files must
adhere to. Below is a snippet that represents a version <code>2.0</code> package.
See <a href="repo/meta/schema/package-schema.json"><code>repo/meta/schema/package-schema.json</code></a> for the full json schema outlining
what properties are available for each corresponding version of a package.</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>packagingVersion<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>2.0<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1.2.3<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>tags<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>mesosphere<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>framework<span class="pl-pds">"</span></span>],
  <span class="pl-s"><span class="pl-pds">"</span>maintainer<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>help@bar.io<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Does baz.<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>scm<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>https://github.com/bar/foo.git<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>website<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://bar.io/foo<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>framework<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>postInstallNotes<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Have fun foo-ing and baz-ing!<span class="pl-pds">"</span></span>
}</pre></div>

<h6>
<a id="mindcosreleaseversion" class="anchor" href="#mindcosreleaseversion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>.minDcosReleaseVersion</code>
</h6>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>not supported</td>
</tr>
<tr>
<td>3.0</td>
<td>optional</td>
</tr>
</tbody>
</table>

<p>Introduced in <code>packagingVersion</code> <code>3.0</code>, <code>.minDcosReleaseVersion</code> can be specified as a property of <code>package.json</code>.
When <code>.minDcosReleaseVersion</code> is specified the package will only be made available to DC/OS clusters with a DC/OS
Release Version greater than or equal to (<code>&gt;=</code>) the value specified.</p>

<h4>
<a id="configjson" class="anchor" href="#configjson" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>config.json</code>
</h4>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>optional</td>
</tr>
<tr>
<td>3.0</td>
<td>optional</td>
</tr>
</tbody>
</table>

<p>This file describes the configuration properties supported by the package, represented as a
<a href="http://spacetelescope.github.io/understanding-json-schema/">json-schema</a>. Each property can specify whether or not it
is required, a default value, as well as some basic validation.</p>

<p>Users can then <a href="https://docs.mesosphere.com/1.7/usage/services/config/">override specific values</a> at
installation time by passing an options file to the DC/OS CLI or by setting config values through the
DC/OS UI (since DC/OS 1.7).</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>object<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>properties<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>object<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>properties<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>baz<span class="pl-pds">"</span></span>: {
          <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>integer<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>How many times to do baz.<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>minimum<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
          <span class="pl-s"><span class="pl-pds">"</span>maximum<span class="pl-pds">"</span></span>: <span class="pl-c1">16</span>,
          <span class="pl-s"><span class="pl-pds">"</span>required<span class="pl-pds">"</span></span>: <span class="pl-c1">false</span>,
          <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>: <span class="pl-c1">4</span>
        }
      },
      <span class="pl-s"><span class="pl-pds">"</span>required<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>baz<span class="pl-pds">"</span></span>]
    }
  },
  <span class="pl-s"><span class="pl-pds">"</span>required<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>]
}</pre></div>

<h4>
<a id="marathonjsonmustache" class="anchor" href="#marathonjsonmustache" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>marathon.json.mustache</code>
</h4>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>required</td>
</tr>
<tr>
<td>3.0</td>
<td>optional</td>
</tr>
</tbody>
</table>

<p>This file is a <a href="http://mustache.github.io/">mustache template</a> that when rendered will create a
<a href="http://github.com/mesosphere/marathon">Marathon</a> app definition capable of running your service.</p>

<p>Variables in the mustache template will be evaluated from a union object created by merging three objects in the
following order:</p>

<ol>
<li><p>Defaults specified in <code>config.json</code></p></li>
<li><p>User supplied options from either the DC/OS CLI or the DC/OS UI</p></li>
<li><p>The contents of <code>resource.json</code></p></li>
</ol>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>cpus<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>mem<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1024<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>instances<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>args<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>{{{foo.baz}}}<span class="pl-pds">"</span></span>],
  <span class="pl-s"><span class="pl-pds">"</span>container<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>DOCKER<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>docker<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>image<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>{{resource.assets.container.docker.foo23b1cfe8e04a}}<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>network<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>BRIDGE<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>portMappings<span class="pl-pds">"</span></span>: [
        {
          <span class="pl-s"><span class="pl-pds">"</span>containerPort<span class="pl-pds">"</span></span>: <span class="pl-c1">8080</span>,
          <span class="pl-s"><span class="pl-pds">"</span>hostPort<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
          <span class="pl-s"><span class="pl-pds">"</span>servicePort<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
          <span class="pl-s"><span class="pl-pds">"</span>protocol<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>tcp<span class="pl-pds">"</span></span>
        }
      ]
    }
  }
}</pre></div>

<p>See the
<a href="https://mesosphere.github.io/marathon/docs/rest-api.html">Marathon API Documentation</a>
for more detailed instruction on app definitions.</p>

<h4>
<a id="commandjson" class="anchor" href="#commandjson" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>command.json</code>
</h4>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>optional</td>
</tr>
<tr>
<td>3.0</td>
<td>optional <strong>[Deprecated]</strong>
</td>
</tr>
</tbody>
</table>

<p>As of <code>packagingVersion</code> <code>3.0</code>, <code>command.json</code> is deprecated in favor of the <code>.cli</code> property of <code>resources.json</code>.
See <a href="#cli-resources">CLI Resources</a> for details.</p>

<p>Describes how to install the package's package's CLI via pip, the Python package manager. This document represents the
format of a Pip requirements file where each element in the array is a line in the requirements file.</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>pip<span class="pl-pds">"</span></span>: [
    <span class="pl-s"><span class="pl-pds">"</span>https://pypi.python.org/packages/source/f/foo/foo-1.2.3.tar.gz<span class="pl-pds">"</span></span>
  ]
}</pre></div>

<h4>
<a id="resourcejson" class="anchor" href="#resourcejson" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>resource.json</code>
</h4>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>optional</td>
</tr>
<tr>
<td>3.0</td>
<td>optional</td>
</tr>
</tbody>
</table>

<p>This file contains all of the externally hosted resources (E.g. Docker images, HTTP objects and
images) needed to install the application.</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>icon-small<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/small.png<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>icon-medium<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/medium.png<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>icon-large<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/large.png<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>screenshots<span class="pl-pds">"</span></span>: [
      <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/screen-1.png<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/screen-2.png<span class="pl-pds">"</span></span>
    ]
  },
  <span class="pl-s"><span class="pl-pds">"</span>assets<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>uris<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>log4j-properties<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://some.org/foo/log4j.properties<span class="pl-pds">"</span></span>
    },
    <span class="pl-s"><span class="pl-pds">"</span>container<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>docker<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>23b1cfe8e04a<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>some-org/foo:1.0.0<span class="pl-pds">"</span></span>
      }
    }
  }
}</pre></div>

<h5>
<a id="docker-images" class="anchor" href="#docker-images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Docker Images</h5>

<p>For the Docker image, please use the image ID for the referenced image. You can find this by
pulling the image locally and running <code>docker images some-org/foo:1.0.0</code>.</p>

<h5>
<a id="images" class="anchor" href="#images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Images</h5>

<p>While <code>images</code> is an optional field, it is highly recommended you include icons and screenshots
in <code>resource.json</code> and update the path definitions accordingly. Specifications are as follows:</p>

<ul>
<li>
<code>icon-small</code>: 48px (w) x 48px (h)</li>
<li>
<code>icon-medium</code>: 96px (w) x 96px (h)</li>
<li>
<code>icon-large</code>: 256px (w) x 256px (h)</li>
<li>
<code>screenshots[...]</code>: 1200px (w) x 675px (h)</li>
</ul>

<p><strong>NOTE:</strong> To ensure your service icons look beautiful on retina-ready displays,
please supply 2x versions of all icons. No changes are needed to
<code>resource.json</code> - simply supply an additional icon file with the text <code>@2x</code> in
the name before the file extension.
For example, the icon <code>icon-cassandra-small.png</code> would have a retina-ready
alternate image named <code>icon-cassandra-small@2x.png</code>.</p>

<h5>
<a id="cli-resources" class="anchor" href="#cli-resources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CLI Resources</h5>

<table>
<thead>
<tr>
<th>Packaging Version</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2.0</td>
<td>not supported</td>
</tr>
<tr>
<td>3.0</td>
<td>optional</td>
</tr>
</tbody>
</table>

<p>The new <code>.cli</code> property allows for a package to configure native CLI subcommands for several platforms and
architectures.</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>cli<span class="pl-pds">"</span></span>:{
    <span class="pl-s"><span class="pl-pds">"</span>binaries<span class="pl-pds">"</span></span>:{
      <span class="pl-s"><span class="pl-pds">"</span>darwin<span class="pl-pds">"</span></span>:{
        <span class="pl-s"><span class="pl-pds">"</span>x86-64<span class="pl-pds">"</span></span>:{
          <span class="pl-s"><span class="pl-pds">"</span>contentHash<span class="pl-pds">"</span></span>:[
            { <span class="pl-s"><span class="pl-pds">"</span>algo<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>sha256<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>...<span class="pl-pds">"</span></span> }
          ],
          <span class="pl-s"><span class="pl-pds">"</span>kind<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>executable<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>https://some.org/foo/1.0.0/cli/darwin/dcos-foo<span class="pl-pds">"</span></span>
        }
      },
      <span class="pl-s"><span class="pl-pds">"</span>linux<span class="pl-pds">"</span></span>:{
        <span class="pl-s"><span class="pl-pds">"</span>x86-64<span class="pl-pds">"</span></span>:{
          <span class="pl-s"><span class="pl-pds">"</span>contentHash<span class="pl-pds">"</span></span>:[
            { <span class="pl-s"><span class="pl-pds">"</span>algo<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>sha256<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>...<span class="pl-pds">"</span></span> }
          ],
          <span class="pl-s"><span class="pl-pds">"</span>kind<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>executable<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>https://some.org/foo/1.0.0/cli/linux/dcos-foo<span class="pl-pds">"</span></span>
        }
      },
      <span class="pl-s"><span class="pl-pds">"</span>windows<span class="pl-pds">"</span></span>:{
        <span class="pl-s"><span class="pl-pds">"</span>x86-64<span class="pl-pds">"</span></span>:{
          <span class="pl-s"><span class="pl-pds">"</span>contentHash<span class="pl-pds">"</span></span>:[
            { <span class="pl-s"><span class="pl-pds">"</span>algo<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>sha256<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>...<span class="pl-pds">"</span></span> }
          ],
          <span class="pl-s"><span class="pl-pds">"</span>kind<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>executable<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>https://some.org/foo/1.0.0/cli/windows/dcos-foo<span class="pl-pds">"</span></span>
        }
      }
    }
  }
}</pre></div>

<h3>
<a id="submit-your-package" class="anchor" href="#submit-your-package" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Submit your Package</h3>

<p>Developers are invited to publish a package containing their DC/OS Service by submitting a Pull Request targeted at
the <code>version-3.x</code> branch of this repo.</p>

<p>Full Instructions:</p>

<ol>
<li>
<p>Fork this repo and clone the fork:</p>

<div class="highlight highlight-source-shell"><pre>git clone https://github.com/<span class="pl-k">&lt;</span>user<span class="pl-k">&gt;</span>/universe.git /path/to/universe</pre></div>
</li>
<li>
<p>Ensure that the <code>jsonschema</code> command line tool is installed:</p>

<div class="highlight highlight-source-shell"><pre>sudo pip install jsonschema</pre></div>
</li>
<li>
<p>Run the verification and build script:</p>

<div class="highlight highlight-source-shell"><pre>scripts/build.sh</pre></div>
</li>
<li><p>Verify all build steps completed successfully</p></li>
<li><p>Submit a pull request against the <code>version-3.x</code> branch with your changes. Every pull request opened will have a set
of automated verifications run against it. These automated verification are reported against the pull request using
the GitHub status API. All verifications must pass in order for a pull request to be eligible for merge.</p></li>
<li>
<p>Respond to manual review feedback provided by the DC/OS Community.</p>

<ul>
<li>Each Pull Request to Universe will also be manually reviewed by a member of the DC/OS Community. To ensure your
package is able to be made available to users as quickly as possible be sure to respond to the feedback provided.</li>
</ul>
</li>
</ol>

<h2>
<a id="repository-consumption-1" class="anchor" href="#repository-consumption-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Repository Consumption</h2>

<p>In order for Universe to be consumed by DC/OS the build process needs to be run to create the Universe Server.</p>

<h3>
<a id="universe-server" class="anchor" href="#universe-server" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Universe Server</h3>

<p>Universe Server is a new component introduce alongside <code>packagingVersion</code> <code>3.0</code>. In order for Universe to be able to
provide packages for many versions of DC/OS at the same time, it is necessary for a server to be responsible for serving
the correct set of packages to a cluster based on the cluster's version.</p>

<p>All Pull Requests opened for Universe and the <code>version-3.x</code> branch will have their Docker image built and published
to the DockerHub image <a href="https://hub.docker.com/r/mesosphere/universe-server/"><code>mesosphere/universe-server</code></a>.
In the artifacts tab of the build results you can find <code>docker/server/marathon.json</code> which can be used to run the
Universe Server for testing in your DC/OS cluster.  For each Pull Request, click the details link of the "Universe Server
Docker image" status report to view the build results.</p>

<h4>
<a id="build-universe-server-locally" class="anchor" href="#build-universe-server-locally" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Build Universe Server locally</h4>

<ol>
<li>
<p>Validate and build the Universe artifacts</p>

<div class="highlight highlight-source-shell"><pre>scripts/build.sh</pre></div>
</li>
<li>
<p>Build the Universe Server Docker image</p>

<div class="highlight highlight-source-shell"><pre>DOCKER_TAG=<span class="pl-s"><span class="pl-pds">"</span>my-package<span class="pl-pds">"</span></span> docker/server/build.bash</pre></div>

<p>This will create a Docker image <code>universe-server:my-package</code> and <code>docker/server/target/marathon.json</code> on your local machine</p>
</li>
<li>
<p>If you would like to publish the built Docker image, run</p>

<div class="highlight highlight-source-shell"><pre>DOCKER_TAG=<span class="pl-s"><span class="pl-pds">"</span>my-package<span class="pl-pds">"</span></span> docker/server/build.bash publish</pre></div>
</li>
</ol>

<h4>
<a id="run-universe-server" class="anchor" href="#run-universe-server" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run Universe Server</h4>

<p>Using the <code>marathon.json</code> that is created when building Universe Server we can run a Universe Server in our DC/OS
Cluster which can then be used to install packages.</p>

<p>Run the following commands to configure DC/OS to use the custom Universe Server</p>

<div class="highlight highlight-source-shell"><pre>dcos marathon app add marathon.json
dcos package repo add --index=0 dev-universe http://universe.marathon.mesos:8085/repo</pre></div>

<h3>
<a id="consumption-protocol" class="anchor" href="#consumption-protocol" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Consumption Protocol</h3>

<p>A DC/OS Cluster can be configured to point to multiple Universe Servers; each Universe Server will be fetched via
HTTPS or HTTP. When a DC/OS Cluster attempts to fetch the package set from a Universe Server, the Universe Server
will provide ONLY those packages which can be run on the cluster.</p>

<p>For example:
A DC/OS 1.6.1 Cluster will only receive packages with a <code>minDcosReleaseVersion</code> less than or equal to (<code>&lt;=</code>) <code>1.6.1</code>
in the format the DC/OS Cluster expects.</p>

<pre><code> +----------------------+   +-----------------------+
 │public universe server│   │private universe server│
 +----------------------+   +-----------------------+
                http \         / http
                      \       /
                       \     /
                       +-----+           +--------+
                       │DC/OS│-----------│Marathon│
                       +-----+    http   +--------+
</code></pre>

<h3>
<a id="supported-dcos-versions" class="anchor" href="#supported-dcos-versions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Supported DC/OS Versions</h3>

<p>Currently Universe Server provides support for the following versions of DC/OS</p>

<table>
<thead>
<tr>
<th>DC/OS Release Version</th>
<th>Support Level</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.6.1</td>
<td>Full Support</td>
</tr>
<tr>
<td>1.7</td>
<td>Full Support</td>
</tr>
<tr>
<td>1.8</td>
<td>Full Support</td>
</tr>
</tbody>
</table>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/mesosphere">mesosphere</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
